# ğŸ›ï¸ AI-Powered Shopping Mall

<img width="1912" height="3555" alt="Image" src="https://github.com/user-attachments/assets/e5784e83-efc6-46ba-b924-dbc6a6c760cb" />
<img width="1912" height="1029" alt="Image" src="https://github.com/user-attachments/assets/0920bfd6-4c87-4094-90d7-0001c8548351" />

> **AI ê¸°ë°˜ ëŒ€í™”í˜• ì¶”ì²œ ì‹œìŠ¤í…œì„ íƒ‘ì¬í•œ í˜„ëŒ€ì ì¸ ì‡¼í•‘ëª° í”Œë«í¼**  
> ì‹¤ì‹œê°„ ì‚¬ìš©ì í–‰ë™ ë¶„ì„ê³¼ ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰ì„ í†µí•œ ê°œì¸í™”ëœ ìƒí’ˆ ì¶”ì²œ ì„œë¹„ìŠ¤

## ğŸš€ ì£¼ìš” íŠ¹ì§•

- **ğŸ¤– AI ëŒ€í™”í˜• ì¶”ì²œ**: GPT-4ì™€ ë²¡í„° ìœ ì‚¬ë„ ê¸°ë°˜ ê°œì¸í™” ì¶”ì²œ
- **âš¡ ì‹¤ì‹œê°„ ì²˜ë¦¬**: Kafka ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì‹¤ì‹œê°„ ì‚¬ìš©ì í–‰ë™ ë¶„ì„  
- **ğŸ›¡ï¸ ê³ ê°€ìš©ì„±**: Circuit Breakerì™€ ë‹¤ì¸µ ìºì‹±ìœ¼ë¡œ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤
- **ğŸ“ˆ í™•ì¥ ê°€ëŠ¥**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ì™€ ë…ë¦½ì ì¸ ML íŒŒì´í”„ë¼ì¸

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### Frontend
| ê¸°ìˆ  | ì„¤ëª… |
|------|------|
| **Template Engine** | Thymeleaf |
| **CSS Framework** | Bootstrap 5 |
| **Ajax Communication** | XMLHttpRequest, Fetch API |

### Backend Core
| ì¹´í…Œê³ ë¦¬ | ê¸°ìˆ  ìŠ¤íƒ |
|----------|-----------|
| **Framework** | Spring Boot 3.1.4, Spring Security 6.x (JWT), Spring Data JPA, Spring WebFlux |
| **Database** | PostgreSQL + pgvector, MariaDB, Redis, Elasticsearch |
| **Storage** | Firebase Storage |
| **Message Queue** | Apache Kafka, Zookeeper |

### AI/ML Services
| ê¸°ìˆ  | ìš©ë„ |
|------|------|
| **FastAPI** | Python ì„ë² ë”© ì„œë¹„ìŠ¤ |
| **Sentence Transformers** | í…ìŠ¤íŠ¸ ì„ë² ë”© (384ì°¨ì›) |
| **OpenAI GPT-4** | ëŒ€í™”í˜• AI ë° ì„ í˜¸ë„ ë¶„ì„ |

### Data Access & Mapping
- **ORM**: JPA/Hibernate, QueryDSL, MyBatis
- **Mapping**: MapStruct (DTO ë§¤í•‘)

### Performance & Resilience
- **Circuit Breaker**: Resilience4j
- **Caching**: EHCache (ë¡œì»¬), Redis (ë¶„ì‚°)
- **Connection Pool**: Apache Commons Pool2

### Monitoring & DevOps
- **Metrics**: Micrometer, Prometheus, Spring Boot Actuator
- **Development**: Lombok, JUnit 5, Docker & Docker Compose

### Architecture Patterns
- Event-Driven Architecture (Kafka)
- Microservices Pattern (AI ì„œë¹„ìŠ¤ ë¶„ë¦¬)
- CQRS Pattern (Command/Query ë¶„ë¦¬)
- Outbox Pattern (íŠ¸ëœì­ì…˜ ë³´ì¥)
- Circuit Breaker Pattern (ì¥ì•  ëŒ€ì‘)
- Cache-Aside Pattern (ìºì‹± ì „ëµ)

## ğŸ—ï¸ ì¸í”„ë¼ êµ¬ì„±

```yaml
Services:
  - Spring Boot Application (Port: 8080)
  - PostgreSQL + pgvector (Port: 5432)
  - Redis Cache (Port: 6379)
  - Kafka Broker (Port: 9092)
  - Elasticsearch (Port: 9200)
  - FastAPI ML Service (Port: 8000)
```

## ğŸ“Š í•µì‹¬ ê¸°ëŠ¥

### ğŸ¤– AI ê¸°ë°˜ ëŒ€í™”í˜• ì¶”ì²œ ì‹œìŠ¤í…œ
- ì‹¤ì‹œê°„ ì‚¬ìš©ì í–‰ë™ ë¶„ì„
- ë²¡í„° ìœ ì‚¬ë„ ê¸°ë°˜ ìƒí’ˆ ì¶”ì²œ
- ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ì´í•´ ë° ì„ í˜¸ë„ ë¶„ì„

### âš¡ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ì²˜ë¦¬
- Kafka ê¸°ë°˜ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°
- ë¹„ë™ê¸° ë©”ì‹œì§€ ì²˜ë¦¬
- ì‹¤ì‹œê°„ íŠ¸ë Œë“œ ë¶„ì„

### ğŸ›¡ï¸ ê³ ê°€ìš©ì„± ì•„í‚¤í…ì²˜
- Circuit Breakerë¡œ ì¥ì•  ê²©ë¦¬
- ë‹¤ì¸µ ìºì‹± ì „ëµ (L1: EHCache, L2: Redis)
- íŠ¸ëœì­ì…˜ ì•„ì›ƒë°•ìŠ¤ íŒ¨í„´

### ğŸ”§ í™•ì¥ ê°€ëŠ¥í•œ ML íŒŒì´í”„ë¼ì¸
- ë…ë¦½ì ì¸ ML ì„œë¹„ìŠ¤ (FastAPI)
- ì„ë² ë”© ë²¡í„° ê²€ìƒ‰ (pgvector)
- GPT-4 API í†µí•©

---

# ğŸ—ï¸ ëŒ€í™”í˜• ìƒí’ˆ ì¶”ì²œ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

## 1. ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†Œ

### ğŸ”· Core Services
- **Spring Boot Backend**: ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„
- **ML Service (FastAPI)**: ì„ë² ë”© ìƒì„± ì„œë¹„ìŠ¤ (384ì°¨ì›)
- **PostgreSQL + pgvector**: ë©”ì¸ DB + ë²¡í„° ê²€ìƒ‰
- **Elasticsearch**: ëŒ€í™” ë‚´ìš© ê²€ìƒ‰ ë° ë¶„ì„
- **Redis**: ìºì‹± ë° ì‹¤ì‹œê°„ ë°ì´í„°
- **Kafka**: ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°

## 2. ì£¼ìš” ë°ì´í„° í”Œë¡œìš°

### ğŸ“Œ Flow 1: ìƒí’ˆ ë“±ë¡ â†’ ì„ë² ë”© ìƒì„±
```
1. ProductController.addProduct()
   â†“
2. ProductService.getAddProduct()
   - ìƒí’ˆ ì •ë³´ DB ì €ì¥
   - ProductEmbeddingService.createAndSaveEmbeddingAsync() í˜¸ì¶œ
   â†“
3. ProductEmbeddingService (ë¹„ë™ê¸°)
   - EmbeddingClient â†’ ML Service í˜¸ì¶œ
   - 384ì°¨ì› ë²¡í„° ìƒì„±
   - product.description_vector ì—…ë°ì´íŠ¸
   â†“
4. pgvector ì¸ë±ìŠ¤ ìë™ ì—…ë°ì´íŠ¸
```

### ğŸ“Œ Flow 2: ì‚¬ìš©ì ëŒ€í™” â†’ ì„ í˜¸ë„ ë¶„ì„
```
1. ConversationController.sendMessage()
   â†“
2. ConversationCommandService.addMessage()
   - DB ì €ì¥ (conversation_message)
   - Outbox íŒ¨í„´ìœ¼ë¡œ ì´ë²¤íŠ¸ ì €ì¥
   â†“
3. OutboxDispatcher (ìŠ¤ì¼€ì¤„ëŸ¬)
   - Kafkaë¡œ "conv-msg-created" ë°œí–‰
   â†“
4. Kafka Consumers (ë³‘ë ¬ ì²˜ë¦¬)
   â”œâ”€ MsgCreatedConsumer
   â”‚  â””â”€ Elasticsearch ì¸ë±ì‹±
   â”œâ”€ PreferenceAnalysisConsumer
   â”‚  â””â”€ ChatGPTë¡œ ì„ í˜¸ë„ ë¶„ì„
   â”‚  â””â”€ user_preference í…Œì´ë¸” ì—…ë°ì´íŠ¸
   â”‚  â””â”€ Redis ìºì‹±
   â””â”€ RecommendationEventProcessor
      â””â”€ ì‹¤ì‹œê°„ ì¶”ì²œ ì—…ë°ì´íŠ¸
```

### ğŸ“Œ Flow 3: ì¶”ì²œ ìƒì„± í”„ë¡œì„¸ìŠ¤
```
1. ConversationalRecommendationService.processUserMessage()
   â†“
2. EnhancedRecommendationService.recommendForUser()
   â”œâ”€ Redis ìºì‹œ í™•ì¸
   â”œâ”€ ì‚¬ìš©ì ì„ í˜¸ë„ ì¡°íšŒ (user_preference)
   â”œâ”€ ë©”ì‹œì§€ ì„ë² ë”© ìƒì„± (ML Service)
   â””â”€ ë‹¤ì¤‘ ì „ëµ ì¶”ì²œ
      â”œâ”€ ë²¡í„° ìœ ì‚¬ë„ (40%) - ProductVectorRepository
      â”œâ”€ ì¹´í…Œê³ ë¦¬ ì„ í˜¸ë„ (30%) - ì„ í˜¸ë„ ê¸°ë°˜
      â”œâ”€ ê°€ê²©ëŒ€ í•„í„°ë§ (10%)
      â”œâ”€ íŠ¸ë Œë”© ê°€ì‚°ì  (10%) - Redis ZSET
      â””â”€ í˜‘ì—… í•„í„°ë§ (10%) - ìœ ì‚¬ ì‚¬ìš©ì
   â†“
3. RecommendationCacheService
   - ê²°ê³¼ ìºì‹± (6ì‹œê°„)
   - ì¶”ì²œ íˆìŠ¤í† ë¦¬ ì €ì¥
```

## 3. ìºì‹± ì „ëµ

### ğŸ”¸ L1 Cache (Application Level)
- **EHCache**: ChatGPT ì‘ë‹µ (30ì´ˆ TTL)

### ğŸ”¸ L2 Cache (Redis)
- **ëŒ€í™” ë‚´ìš©**: ZSETìœ¼ë¡œ ì‹œê³„ì—´ ì €ì¥ (6ì‹œê°„)
- **ì‚¬ìš©ì ì„ í˜¸ë„**: Stringìœ¼ë¡œ JSON ì €ì¥ (24ì‹œê°„)
- **ì¶”ì²œ ê²°ê³¼**: Listë¡œ ì €ì¥ (6ì‹œê°„)
- **íŠ¸ë Œë”© ìƒí’ˆ**: ZSETìœ¼ë¡œ ì ìˆ˜ ê´€ë¦¬
- **ìœ ì‚¬ ì‚¬ìš©ì**: Listë¡œ ì €ì¥

## 4. ì‹¤ì‹œê°„ ì²˜ë¦¬ ì»´í¬ë„ŒíŠ¸

### ğŸ”¹ Event Processors
1. **PreferenceAnalysisConsumer**
   - GPT ê¸°ë°˜ ì‹¤ì‹œê°„ ì„ í˜¸ë„ ë¶„ì„
   - ê°€ì¤‘ì¹˜ ê¸°ë°˜ ì„ í˜¸ë„ ë³‘í•©

2. **RecommendationEventProcessor**
   - ìƒí’ˆ ì¡°íšŒ/êµ¬ë§¤ ì´ë²¤íŠ¸ ì²˜ë¦¬
   - íŠ¸ë Œë”© ì ìˆ˜ ì—…ë°ì´íŠ¸
   - ì¶”ì²œ ì¬ê³„ì‚° ìŠ¤ì¼€ì¤„ë§

3. **ConversationSearchService**
   - Elasticsearch ê¸°ë°˜ ëŒ€í™” ê²€ìƒ‰
   - ì‹œê°„ëŒ€ë³„ í™œë™ íŒ¨í„´ ë¶„ì„
   - íŠ¸ë Œë”© í‚¤ì›Œë“œ ì¶”ì¶œ

## 5. ëª¨ë‹ˆí„°ë§ ë° ê´€ë¦¬

### ğŸ”¸ RecommendationSystemMonitor
- ì‹œìŠ¤í…œ í—¬ìŠ¤ ì²´í¬ (1ë¶„ ì£¼ê¸°)
- ì„±ëŠ¥ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ (5ë¶„ ì£¼ê¸°)
- ì¶”ì²œ í’ˆì§ˆ ë¶„ì„ (ì¼ì¼)

### ğŸ”¸ Metrics
- ìºì‹œ íˆíŠ¸ìœ¨
- í‰ê·  ì‘ë‹µ ì‹œê°„
- ì¶”ì²œ ë‹¤ì–‘ì„± ì ìˆ˜
- ì‚¬ìš©ì ë§Œì¡±ë„

## 6. ì¥ì•  ëŒ€ì‘

### ğŸ›¡ï¸ Circuit Breaker
- ML Service ì¥ì•  â†’ ë¹ˆ ë²¡í„° ë°˜í™˜
- ChatGPT ì¥ì•  â†’ ìºì‹œ/ê¸°ë³¸ê°’ ì‚¬ìš©
- ES ì¥ì•  â†’ Redis ìºì‹œ ìš°ì„ 

### ğŸ›¡ï¸ Outbox Pattern
- íŠ¸ëœì­ì…˜ ë³´ì¥
- ì´ë²¤íŠ¸ ì „ë‹¬ ì‹ ë¢°ì„±
- ë°°ì¹˜ ì²˜ë¦¬ (500ê°œ ë‹¨ìœ„)

## 7. ë°ì´í„° ì¼ê´€ì„±

### ğŸ”„ ë™ê¸°í™”
- **conversation_message** â†” **Elasticsearch**
  - Kafkaë¥¼ í†µí•œ ë¹„ë™ê¸° ë™ê¸°í™”
  - Outbox íŒ¨í„´ìœ¼ë¡œ ì‹ ë¢°ì„± ë³´ì¥

- **product** â†” **description_vector**
  - ìƒí’ˆ ë“±ë¡/ìˆ˜ì • ì‹œ ìë™ ìƒì„±
  - ë°°ì¹˜ ìŠ¤ì¼€ì¤„ëŸ¬ë¡œ ëˆ„ë½ ì²˜ë¦¬

- **user_preference** â†” **Redis Cache**
  - TTL ê¸°ë°˜ ìë™ ê°±ì‹ 
  - ì—…ë°ì´íŠ¸ ì‹œ ì¦‰ì‹œ ë¬´íš¨í™”

## 8. í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### ğŸ“ˆ ìˆ˜í‰ í™•ì¥
- Kafka íŒŒí‹°ì…˜ ì¦ê°€ (í˜„ì¬ 3ê°œ)
- Redis í´ëŸ¬ìŠ¤í„° êµ¬ì„±
- ES ìƒ¤ë“œ ì¦ê°€
- ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸ìŠ¤í„´ìŠ¤ ì¦ê°€

### ğŸ“Š ì„±ëŠ¥ ìµœì í™”
- pgvector ì¸ë±ìŠ¤ íŠœë‹ (lists íŒŒë¼ë¯¸í„°)
- ë°°ì¹˜ ì„ë² ë”© ì²˜ë¦¬
- ë¹„ë™ê¸° ì²˜ë¦¬ í™•ëŒ€
- ìºì‹œ ì›Œë° ì „ëµ

## 9. ë³´ì•ˆ ê³ ë ¤ì‚¬í•­
- API Rate Limiting
- ì‚¬ìš©ìë³„ ìš”ì²­ ì œí•œ
- ë¯¼ê° ì •ë³´ ë§ˆìŠ¤í‚¹
- JWT ê¸°ë°˜ ì¸ì¦

## 10. í–¥í›„ ê°œì„ ì‚¬í•­
- A/B í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬
- ì‹¤ì‹œê°„ í”¼ë“œë°± ë°˜ì˜
- ë‹¤êµ­ì–´ ì§€ì›
- ê³ ê¸‰ í˜‘ì—… í•„í„°ë§
